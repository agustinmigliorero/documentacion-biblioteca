<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="./librerias/bootstrap.min.css" />
    <script src="./librerias/bootstrap.bundle.min.js"></script>
    <style>
      body {
        font-size: 1.25em !important;
        font-family: Arial, Helvetica, sans-serif !important;
      }

      p {
        text-align: justify;
      }

      pre {
        color: #eeeeee;
        padding: 5px;
        border-radius: 3px;
        background-color: #2b2b2b;
      }
    </style>
  </head>
  <body>
    <h1 style="text-align: center" class="mb-5">Documentación del sistema</h1>
    <div class="container">
      <div class="row">
        <div class="col-sm-3 col-12">
          <ul>
            <li><a href="#servidor">Servidor</a></li>
            <ul>
              <li><a href="#modelos">Modelos</a></li>
                <ul>
                    <li><a href="#modelo-usuario">Usuario</a></li>
                    <li><a href="#modelo-libro">Libro</a></li>
                    <li><a href="#modelo-comentario">Comentario</a></li>
                    <li><a href="#modelo-prestamo">Prestamo</a></li>
                    <li><a href="#modelo-reserva">Reserva</a></li>
                </ul>
              <li><a href="#controladores">Controladores</a></li>
              <ul>
                <li><a href="#controlador-usuario">Controladores Usuario</a></li>
                <ul>
                    <li><a href="#controlador-usuario-crearUsuario">crearUsuario</a></li>
                </ul>
              </ul>
            </ul>
            <li>Cliente</li>
            <ul>
              <li>Paginas</li>
              <ul>
                <li>Inicio</li>
                <li>Usuarios</li>
                <ul></ul>
                <li>Libros</li>
                <li>Reservas</li>
                <li>Prestamos</li>
              </ul>
              <li>Componentes</li>
              <li>Utils</li>
            </ul>
            
            
          </ul>
        </div>
        <div class="col-sm-9 col-12">
          <p>
            El siguiente es un sistema de biblioteca diseñado en el marco la
            materia de Practicas Profesionalizantes de 1er año de la carrera de
            tecnicatura superior de análisis de sistemas del instituto superior
            de formación docente y técnica N° 2.
          </p>
          <p>
            Para el proyecto se decidió por un patrón de diseño de software de
            tipo MVC (Modelo, Vista, Controlador). El modelo se encarga de
            manejar los datos y lógica de negocios, las vistas se encargan del
            diseño y presentación desde el lado del cliente y los controladores
            contiene la lógica que actualiza el modelo y las vistas dependiendo
            del tipo de petición que realice el usuario.
          </p>
          <h2 class="mt-4">Tecnologías usadas en el proyecto</h2>
          <hr>
          <h3 class="mt-3">Servidor:</h3>
          <ul>
            <li>
              <b>NodeJS:</b> Es un entorno que permite ejecutar codigo
              JavaScript desde el lado del servidor.
            </li>
            <li><b>Express:</b> Es un framework para NodeJS utilizado para facilitar la creacion de aplicaciones web y APIs</li>
            <li>
              <b>MongoDB:</b> Es un sistema de base de datos NoSQL, orientado a modelos y documentos.
            </li>
            <li>
              <b>Mongoose:</b> Es una libreria que facilita la interaccion desde el servidor con la base de datos mediante esquemas.
            </li>
            <li><b>Passport:</b> Es una libreria diseñada para Express que permite implementar la autenticacion de usuarios con contraseñas encriptadas, ademas de ofrecer distintos metodos de registro.</li>
            <li>
              <b>Joi:</b> Es una libreria que permite realizar validaciones desde el lado del servidor.
            </li>
            <li>
              <b>Body Parser:</b> Es una librería de NodeJS utilizada para
              formatear la información recibida por el servidor de formato JSON
              a JavaScript.
            </li>
            
            <li>
              <b>Express Session:</b> Utilizado para mantener y almacenar las sesiones en el navegador de los clientes.
            </li>

          </ul>
          
          <p>
            Links a sus documentaciones: <a href="https://nodejs.org/en" target="_blank">NodeJS</a>, <a href="https://expressjs.com/es/" target="_blank">Express</a>, <a href="https://www.mongodb.com/es" target="_blank">MongoDB</a>, <a href="https://mongoosejs.com/" target="_blank">Mongoose</a>,  <a href="https://www.passportjs.org/" target="_blank">PassportJS</a>,  <a href="https://joi.dev/" target="_blank">Joi</a>, <a href="https://www.npmjs.com/package/body-parser" target="_blank">Body Parser</a>, <a href="https://www.npmjs.com/package/express-session" target="_blank">Express Session</a>
          </p>
          <h3 class="mt-3">Cliente:</h3>
          <ul>
            <li>
              <b>Vite:</b> Es una herramienta utilizada para crear un entorno de desarrollo web, en este caso se utilizo para el cliente con React.
            </li>
            <li>
              <b>ReactJS:</b> Es una biblioteca Javascript de código abierto diseñada para crear interfaces de usuario con el objetivo de facilitar el desarrollo de aplicaciones en una sola página (SPA) mediante la creacion de componentes.
            </li>
            <li>
              <b>React Router:</b> Es una librería de enrutamiento construida sobre React que nos va a permitir crear rutas dinamicas de manera sencilla.
            </li>
            <li>
              <b>Bootstrap:</b>
              Es una librería de CSS que otorga estilos prediseñados para facilitar la creacion de interfaces.
            </li>
          </ul>
          <p>
            Links a sus documentaciones: <a href="https://vitejs.dev" target="_blank">Vite</a>, <a href="https://reactjs.org" target="_blank">ReactJS</a>, <a href="https://reactrouter.com/en/main" target="_blank">React Router</a>, <a href="https://getbootstrap.com" target="_blank">Bootstrap</a>
          </p>
          

          <h1 id="servidor" class="mt-5">Servidor:</h1>
          <hr>
          <h2 id="modelos" class="mt-4">Modelos</h2>
          <p>Los modelos son la estructura que indica cual es la forma en la que están estructurados los documentos que se almacenan en una colección de documentos.</p>
          <h3 id="modelo-usuario" class="mt-3">Modelo Usuario</h3>
          <p>
            El siguiente código define un esquema/clase de Mongoose para el
            modelo "Usuario" en una base de datos de MongoDB.
          </p>
          <pre>
<code>const mongoose = require("mongoose");
const Schema = mongoose.Schema;
const passportLocalMongoose = require("passport-local-mongoose");

// MODELO DE LA CLASE USUARIO EN LA BASE DE DATOS
const usuarioSchema = new Schema(
  {
    dni: { type: Number },
    nombre: { type: String },
    apellido: { type: String },
    email: { type: String },
    rol: { default: "Estudiante", type: String },
    activo: { type: Boolean, default: false },
    comentarios: [{ type: Schema.Types.ObjectId, ref: "Comentario" }],
    prestamos: [{ type: Schema.Types.ObjectId, ref: "Prestamo" }],
    reservas: [{ type: Schema.Types.ObjectId, ref: "Reserva" }],
  },
  {
    timestamps: true,
  }
);

usuarioSchema.plugin(passportLocalMongoose); // PLUGIN DE PASSPORT PARA AUTENTICAR USUARIOS

module.exports = mongoose.model("Usuario", usuarioSchema);</code>
          </pre>

          
          <p>
            Propiedades:
            <ul>
                <li>dni: DNI del usuario.</li>
                <li>nombre: Nombre del usuario.</li>
                <li>apellido: Apellido del usuario.</li>
                <li>email: Email del usuario.</li>
                <li>rol: Rol del usuario (por defecto, "Estudiante").</li>
                <li>activo: Estado de actividad del usuario (por defecto, false).</li>
                <li>comentarios: Array de referencias a comentarios hechos por el usuario.</li>
                <li>prestamos: Array de referencias a préstamos hechos por el usuario.</li>
                <li>reservas: Array de referencias a reservas hechas por el usuario</li>
            </ul>
          </p>

          <hr>

          <h3 id="modelo-libro" class="mt-4">Modelo Libro</h3>

          <p>
            El siguiente código define un esquema/clase de Mongoose para el
            modelo "Libro" en una base de datos de MongoDB.
          </p>

<pre><code>const mongoose = require("mongoose");
const prestamo = require("./prestamo");
const Schema = mongoose.Schema;

const schemaLibro = new Schema({
    titulo: { type: String },
    autor: { type: String },
    categoria: { type: String },
    copiaVirtual: { type: String }, // url de la copia virtual
    copiasLibro: { type: Number },
    comentarios: [{ type: Schema.Types.ObjectId, ref: "Comentario" }], // array de comentarios
    descripcion: { type: String },
    imagen: { type: String },
    reservas: [{ type: Schema.Types.ObjectId, ref: "Reserva" }],
    prestamos: [{ type: Schema.Types.ObjectId, ref: "Prestamo" }],
});

module.exports = mongoose.model("Libro", schemaLibro);</code></pre>

<p>
    Propiedades:
<ul>
    <li><b>titulo</b> Título del libro.</li>
    <li><b>autor:</b> Autor del libro.</li>
    <li><b>categoria:</b> Categoría del libro.</li>
    <li><b>copiaVirtual:</b> URL de la copia virtual del libro.</li>
    <li><b>copiasLibro:</b> Número de copias disponibles.</li>
    <li><b>comentarios:</b> Array de referencias a comentarios asociados al libro.</li>
    <li><b>descripcion:</b> Descripción del libro.</li>
    <li><b>imagen:</b> URL de la imagen del libro.</li>
    <li><b>reservas:</b> Array de referencias a reservas asociadas al libro.</li>
    <li><b>prestamos:</b> Array de referencias a préstamos asociados al libro.</li>
</ul>
</p>
<hr>

<h3 id="modelo-comentario" class="mt-4">Modelo Comentario</h3>

<p>
    El siguiente código define un esquema/clase de Mongoose para el
    modelo "Comentario" en una base de datos de MongoDB.
</p>

<pre><code>const moongose = require("mongoose");
const Schema = moongose.Schema;

const schemaPrestamo = new Schema({
    idLibro: { type: Schema.Types.ObjectId, ref: "Libro" },
    documento: { type: Schema.Types.ObjectId, ref: "Usuario" },
    fechaDeInicio: { type: Date },
    fechaDeFin: { type: Date },
    fechaDevolucion: { type: Date },
});

module.exports = moongose.model("Prestamo", schemaPrestamo);</code></pre>

<p>
    Propiedades:
<ul>
    <li><b>titulo:</b> Título del libro.</li>
    <li><b>autor:</b> Autor del libro.</li>
    <li><b>categoria:</b> Categoría del libro.</li>
    <li><b>copiaVirtual:</b> URL de la copia virtual del libro.</li>
    <li><b>copiasLibro:</b> Número de copias disponibles.</li>
    <li><b>comentarios:</b> Array de referencias a comentarios asociados al libro.</li>
    <li><b>descripcion:</b> Descripción del libro.</li>
    <li><b>imagen:</b> URL de la imagen del libro.</li>
    <li><b>reservas:</b> Array de referencias a reservas asociadas al libro.</li>
    <li><b>prestamos:</b> Array de referencias a préstamos asociados al libro.</li>
</ul>
</p>

<hr>

<h3 id="modelo-prestamo" class="mt-4">Modelo Prestamo</h3>

<p>
    El siguiente código define un esquema/clase de Mongoose para el
    modelo "Prestamo" en una base de datos de MongoDB.
</p>

<pre><code>const moongose = require("mongoose");
const Schema = moongose.Schema;

const schemaPrestamo = new Schema({
    idLibro: { type: Schema.Types.ObjectId, ref: "Libro" },
    documento: { type: Schema.Types.ObjectId, ref: "Usuario" },
    fechaDeInicio: { type: Date },
    fechaDeFin: { type: Date },
    fechaDevolucion: { type: Date },
});

module.exports = moongose.model("Prestamo", schemaPrestamo);</code></pre>

<p>
    Propiedades:
    <ul>
        <li><b>idLibro:</b> Referencia al libro prestado.</li>
        <li><b>documento:</b> Referencia al usuario que hizo el préstamo.</li>
        <li><b>fechaDeInicio:</b> Fecha de inicio del préstamo.</li>
        <li><b>fechaDeFin:</b> Fecha de fin del préstamo.</li>
        <li><b>fechaDevolucion:</b> Fecha de devolución del libro.</li>
    </ul>
</p>

<hr>

<h3 id="modelo-reserva" class="mt-4">Modelo Reserva</h3>
<p>
    El siguiente código define un esquema/clase de Mongoose para el
    modelo "Reserva" en una base de datos de MongoDB.
</p>

<pre><code>const moongose = require("mongoose");
const Schema = moongose.Schema;

const schemaReserva = new Schema({
    documento: { type: Schema.Types.ObjectId, ref: "Usuario" },
    idLibro: { type: Schema.Types.ObjectId, ref: "Libro" },
    fechaReserva: { type: Date },
    fechaDevolucion: { type: Date },
    estadoReserva: { type: Boolean, default: true },
});

module.exports = moongose.model("Reserva", schemaReserva);</code></pre>

<p>
    Propiedades:
    <ul>
        <li><b>documento:</b> Referencia al usuario que hizo la reserva.</li>
        <li><b>idLibro:</b> Referencia al libro reservado.</li>
        <li><b>fechaReserva:</b> Fecha de la reserva.</li>
        <li><b>fechaDevolucion:</b> Fecha de devolución de la reserva.</li>
        <li><b>estadoReserva:</b> Estado de la reserva (por defecto, true).</li>
    </ul>
</p>

<hr>

<h2 id="controladores" class="mt-4">Controladores</h2>
<hr>
<p>Uno de los elementos más importantes en un Servidor con una API REST hecha con NodeJS y ExpressJS es la creación de los controladores. Los controladores son responsables de procesar las solicitudes y respuestas del servidor, facilitando la comunicación entre el Cliente y el Servidor</p>
<p>En los controladores se van a repetir frecuentemente los siguientes terminos, asi que vamos a explicarlos un poco.</p>
<ul>
  <li><b>req.body:</b> Este es un objeto dentro de la peticion que contiene los datos enviados desde el cliente en el cuerpo de la peticion HTTP (generalmente una solicitud POST/PUT)</li>
  <li><b>req.params:</b> Es una propiedad de la peticion que nos permite capturar parametros o valores dinamicos de la URL.</li>
</ul>

<p><b>Async/Await</b>: El uso de async y await en JavaScript se utiliza para escribir código asíncrono de una manera más limpia y fácil de leer.</p>
<p>La palabra clave async se utiliza antes de una función para indicar que esa función retornará una Promesa. Esto permite que la función se comporte de manera asíncrona, incluso si contiene operaciones sincrónicas y/o asíncronas. Cuando una función es declarada como async, automáticamente devuelve una Promesa.</p>
<p>La palabra clave await se utiliza dentro de una función async para esperar a que una Promesa se resuelva antes de continuar con la ejecución del código. Esto significa que cuando se encuentra la palabra clave await, la ejecución del código se pausa hasta que la Promesa se resuelva, y luego se reanuda con el valor resuelto de la Promesa.</p>

<hr>
<h2 id="controlador-usuario" class="mt-4">Controladores de Usuario</h2>
<p>En este apartado se definen los controladores para el manejo de los usuarios.</p>
<hr>
<h3 id="controlador-usuario-crearUsuario" class="mt-4">Controlador crearUsuario</h3>

        </div>
      </div>
    </div>
  </body>
</html>
